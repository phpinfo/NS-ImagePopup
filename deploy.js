MooTools.More={version:"1.2.4.4",build:"6f6057dc645fdb7547689183b2311063bd653ddf"};
Element.implement({measure:function(b){var a=function(g){return!!(!g||g.offsetHeight||g.offsetWidth)};if(a(this))return b.apply(this);for(var f=this.getParent(),d=[];!a(f)&&f!=document.body;){d.push(f.expose());f=f.getParent()}a=this.expose();b=b.apply(this);a();d.each(function(g){g()});return b},expose:function(){if(this.getStyle("display")!="none")return $empty;var b=this.style.cssText;this.setStyles({display:"block",position:"absolute",visibility:"hidden"});return function(){this.style.cssText=
b}.bind(this)},getDimensions:function(b){b=$merge({computeSize:false},b);var a={},f=function(c,e){return e.computeSize?c.getComputedSize(e):c.getSize()},d=this.getParent("body");if(d&&this.getStyle("display")=="none")a=this.measure(function(){return f(this,b)});else if(d)try{a=f(this,b)}catch(g){}else a={x:0,y:0};return $chk(a.x)?$extend(a,{width:a.x,height:a.y}):$extend(a,{x:a.width,y:a.height})},getComputedSize:function(b){b=$merge({styles:["padding","border"],plains:{height:["top","bottom"],width:["left",
"right"]},mode:"both"},b);var a={width:0,height:0};switch(b.mode){case "vertical":delete a.width;delete b.plains.width;break;case "horizontal":delete a.height;delete b.plains.height;break}var f=[];$each(b.plains,function(c){c.each(function(e){b.styles.each(function(i){f.push(i=="border"?i+"-"+e+"-width":i+"-"+e)})})});var d={};f.each(function(c){d[c]=this.getComputedStyle(c)},this);var g=[];$each(b.plains,function(c,e){var i=e.capitalize();a["total"+i]=a["computed"+i]=0;c.each(function(j){a["computed"+
j.capitalize()]=0;f.each(function(h){if(h.test(j)){d[h]=d[h].toInt()||0;a["total"+i]+=d[h];a["computed"+j.capitalize()]=a["computed"+j.capitalize()]+d[h]}if(h.test(j)&&e!=h&&(h.test("border")||h.test("padding"))&&!g.contains(h)){g.push(h);a["computed"+i]-=d[h]}})})});["Width","Height"].each(function(c){var e=c.toLowerCase();if($chk(a[e])){a[e]=a[e]+this["offset"+c]+a["computed"+c];a["total"+c]=a[e]+a["total"+c];delete a["computed"+c]}},this);return $extend(d,a)}});var NS=NS||{};
NS.Semaphore=new Class({_s:0,setEnabled:function(b){b=b===undefined||b===null||b;this._s+=1-2*Number(b);if(this._s<0)this._s=0},isEnabled:function(){return this._s==0},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)}});NS=NS||{};
NS.ImagePopup=new Class({Implements:[Options,Events,NS.Semaphore],options:{},_fx:null,initialize:function(b){this.setOptions(b)},append:function(b){b.each(function(a){a.addEvent("click",this.popup.bindWithEvent(this,a.get("href")))}.bind(this))},popup:function(b,a){b.stop();if(this.isEnabled){this.disable();var f=this._getContainer(),d=b.target.getPosition(),g=b.target.getDimensions(),c=new Image;c.onload=function(){f.set("src",a).setStyles({left:d.x,top:d.y,width:g.width,height:g.height});this._popup(c.width,
c.height)}.bind(this);c.src=a}},_getContainer:function(){if(!NS.ImagePopup._cont){NS.ImagePopup._cont=(new Element("img")).setStyles({position:"absolute",left:"0px",top:"0px",visibility:"hidden"}).addClass("ns-imagepopup").inject($$("body")[0]);document.body.addEvent("click",function(b){b.stopPropagation();this._hide()}.bind(this));this._fx=new Fx.Morph(NS.ImagePopup._cont,{duration:100})}return NS.ImagePopup._cont},_popup:function(b,a){var f=this._getContainer(),d=window.getSize(),g=document.body.getScroll();
if(b>500||a>500){b=b;var c=a,e=500;a=500;if(b>c)a=c*e/b;else e=b*a/c;b=e;a=a}f.fade("show");this._fx.start({left:(d.x-b)/2+g.x,top:(d.y-a)/2+g.y,width:b,height:a}).chain(this.enable.bind(this))},_hide:function(){this._getContainer().fade("hide")}});NS.ImagePopup._cont=null;